@using System.Data
@{
    ViewBag.Title = "TienDo";
    Layout = "~/Views/Shared/_Layout _TienDo.cshtml";
}

<style>
    body {
        font-family: Arial;
    }

    /* Style the tab */
    .tab {
        overflow: hidden;
        border: 1px solid #ccc;
        background-color: #f1f1f1;
    }

        /* Style the buttons inside the tab */
        .tab button {
            background-color: inherit;
            float: left;
            border: none;
            outline: none;
            cursor: pointer;
            padding: 14px 16px;
            transition: 0.3s;
            font-size: 17px;
        }

    .t {
        width: 100%;
        height: 500px;
    }
    /* Change background color of buttons on hover */
    .tab button:hover {
        background-color: #ddd;
    }

    /* Create an active/current tablink class */
    .tab button.active {
        background-color: #ccc;
    }

    /* Style the tab content */
    .tabcontent {
        display: none;
        padding: 6px 12px;
        border: 1px solid #ccc;
        border-top: none;
    }

    .table tr, .table th, .table td {
        border: 1px solid black !important;
    }

    .table th {
        text-align: center;
    }

    h5 {
        float: right;
    }
</style>
<br /> <br />

<div class="tab">
    <button class="tablinks" onclick="openCity(event, 'TienDo1')">Tiến độ thực hiện theo đơn vị.</button>
    <button class="tablinks" onclick="openCity(event, 'TienDo2')">Tiến độ thực hiện theo cán bộ.</button>
    <button class="tablinks" onclick="openCity(event, 'TienDo3')">Tiến độ thực hiện theo loại thuế.</button>
</div>
<div class="t">
    <div id="TienDo1" class="tabcontent">
        <h3>Tiến độ thực hiện theo đơn vị - tính đến ngày @DateTime.Now.Day/@DateTime.Now.Month/@DateTime.Now.Year.</h3>
        <h5>Đơn vị: Triệu đồng</h5>
        <table class="table">
            <tr style="font-size:15px;">

                <th style="width:5%">
                    Mã
                </th>
                <th style="width:10%">
                    Chi tiêu
                </th>
                <th style="width:13%">
                    Số thu tháng
                </th>

                <th style="width:13%">
                    Số thu quý
                </th>
                <th style="width:13%">
                    Kế hoạch quý
                </th>
                <th style="width:10%">
                    Tỉ lệ quý
                </th>
                <th style="width:13%">
                    Số thu năm
                </th>
                <th style="width:13%">
                    Kế hoạch năm
                </th>
                <th style="width:10%">
                    Tỉ lệ năm
                </th>
            </tr>

            @for (int i = 0; i < WebReport.Controllers.HomeController.TienDoCBQL().Rows.Count; i++)
            {
                if (WebReport.Controllers.HomeController.TienDoCBQL().Rows[i][1].ToString().Equals("0000000"))
                {
                    <tr style="font-weight:bold;font-size:15px">
                        <td>@WebReport.Controllers.HomeController.TienDoCBQL().Rows[i][1]</td>
                        <td>@WebReport.Controllers.HomeController.TienDoCBQL().Rows[i][2]</td>
                        <td> @Convert.ToDecimal((long.Parse(WebReport.Controllers.HomeController.TienDoCBQL().Rows[i][3].ToString())) / 1000000).ToString("#,##0")</td>
                        <td> @Convert.ToDecimal((long.Parse(WebReport.Controllers.HomeController.TienDoCBQL().Rows[i][4].ToString())) / 1000000).ToString("#,##0")</td>
                        <td> @Convert.ToDecimal((long.Parse(WebReport.Controllers.HomeController.TienDoCBQL().Rows[i][5].ToString())) / 1000000).ToString("#,##0")</td>
                        <td> @Convert.ToDecimal((long.Parse(WebReport.Controllers.HomeController.TienDoCBQL().Rows[i][6].ToString())) / 1000000).ToString("#,##0")</td>
                        <td> @Convert.ToDecimal((long.Parse(WebReport.Controllers.HomeController.TienDoCBQL().Rows[i][7].ToString())) / 1000000).ToString("#,##0")</td>
                       <td> @Convert.ToDecimal((long.Parse(WebReport.Controllers.HomeController.TienDoCBQL().Rows[i][8].ToString())) / 1000000).ToString("#,##0")</td>
                       <td> @Convert.ToDecimal((long.Parse(WebReport.Controllers.HomeController.TienDoCBQL().Rows[i][9].ToString())) / 1000000).ToString("#,##0")</td>
                    </tr>
                }
                else
                {
                    <tr>
                        <td>@WebReport.Controllers.HomeController.TienDoCBQL().Rows[i][1]</td>
                        <td>@WebReport.Controllers.HomeController.TienDoCBQL().Rows[i][2]</td>
                        <td> @Convert.ToDecimal((long.Parse(WebReport.Controllers.HomeController.TienDoCBQL().Rows[i][3].ToString())) / 1000000).ToString("#,##0")</td>
                        <td> @Convert.ToDecimal((long.Parse(WebReport.Controllers.HomeController.TienDoCBQL().Rows[i][4].ToString())) / 1000000).ToString("#,##0")</td>
                        <td> @Convert.ToDecimal((long.Parse(WebReport.Controllers.HomeController.TienDoCBQL().Rows[i][5].ToString())) / 1000000).ToString("#,##0")</td>
                        <td> @Convert.ToDecimal((long.Parse(WebReport.Controllers.HomeController.TienDoCBQL().Rows[i][6].ToString())) / 1000000).ToString("#,##0")</td>
                        <td> @Convert.ToDecimal((long.Parse(WebReport.Controllers.HomeController.TienDoCBQL().Rows[i][7].ToString())) / 1000000).ToString("#,##0")</td>
                        <td> @Convert.ToDecimal((long.Parse(WebReport.Controllers.HomeController.TienDoCBQL().Rows[i][8].ToString())) / 1000000).ToString("#,##0")</td>
                       <td> @Convert.ToDecimal((long.Parse(WebReport.Controllers.HomeController.TienDoCBQL().Rows[i][9].ToString())) / 1000000).ToString("#,##0")</td>
                    </tr>
                }

            }

        </table>
    </div>

    <div id="TienDo2" class="tabcontent">
        <h3>Tiến độ thực hiện theo cán bộ - tính đến ngày @DateTime.Now.Day/@DateTime.Now.Month/@DateTime.Now.Year.</h3>
        <h5>Đơn vị: Triệu đồng</h5>
        <table class="table">
            <tr style="font-size:15px;width:10%">

                <th>
                    Mã
                </th>
                <th>
                    Chi tiêu
                </th>
                <th>
                    Số thu tháng
                </th>

                <th>
                    Số thu quý
                </th>
                <th>
                    Kế hoạch quý
                </th>
                <th>
                    Tỉ lệ quý
                </th>
                <th>
                    Số thu năm
                </th>
                <th>
                    Kế hoạch năm
                </th>
                <th>
                    Tỉ lệ năm
                </th>
            </tr>
            @for (int i = 0; i < WebReport.Controllers.HomeController.TienDoMLNS().Rows.Count; i++)
            {
                if (WebReport.Controllers.HomeController.TienDoMLNS().Rows[i][1].ToString().Equals("0000000"))
                {
                    <tr style="font-weight:bold;font-size:15px">
                        <td>@WebReport.Controllers.HomeController.TienDoMLNS().Rows[i][1]</td>
                        <td>@WebReport.Controllers.HomeController.TienDoMLNS().Rows[i][2]</td>
                        <td> @Convert.ToDecimal((long.Parse(WebReport.Controllers.HomeController.TienDoMLNS().Rows[i][3].ToString())) / 1000000).ToString("#,##0")</td>
                        <td> @Convert.ToDecimal((long.Parse(WebReport.Controllers.HomeController.TienDoMLNS().Rows[i][4].ToString())) / 1000000).ToString("#,##0")</td>
                        <td> @Convert.ToDecimal((long.Parse(WebReport.Controllers.HomeController.TienDoMLNS().Rows[i][5].ToString())) / 1000000).ToString("#,##0")</td>
                        <td> @Convert.ToDecimal((long.Parse(WebReport.Controllers.HomeController.TienDoMLNS().Rows[i][6].ToString())) / 1000000).ToString("#,##0")</td>
                        <td> @Convert.ToDecimal((long.Parse(WebReport.Controllers.HomeController.TienDoMLNS().Rows[i][7].ToString())) / 1000000).ToString("#,##0")</td>
                        <td> @Convert.ToDecimal((long.Parse(WebReport.Controllers.HomeController.TienDoMLNS().Rows[i][8].ToString())) / 1000000).ToString("#,##0")</td>
                        <td> @Convert.ToDecimal((long.Parse(WebReport.Controllers.HomeController.TienDoMLNS().Rows[i][9].ToString())) / 1000000).ToString("#,##0")</td>
                    </tr>
                }
                else
                {
                    <tr>
                        <td>@WebReport.Controllers.HomeController.TienDoMLNS().Rows[i][1]</td>
                        <td>@WebReport.Controllers.HomeController.TienDoMLNS().Rows[i][2]</td>
                        <td> @Convert.ToDecimal((long.Parse(WebReport.Controllers.HomeController.TienDoMLNS().Rows[i][3].ToString())) / 1000000).ToString("#,##0")</td>
                        <td> @Convert.ToDecimal((long.Parse(WebReport.Controllers.HomeController.TienDoMLNS().Rows[i][4].ToString())) / 1000000).ToString("#,##0")</td>
                        <td> @Convert.ToDecimal((long.Parse(WebReport.Controllers.HomeController.TienDoMLNS().Rows[i][5].ToString())) / 1000000).ToString("#,##0")</td>
                        <td> @Convert.ToDecimal((long.Parse(WebReport.Controllers.HomeController.TienDoMLNS().Rows[i][6].ToString())) / 1000000).ToString("#,##0")</td>
                        <td> @Convert.ToDecimal((long.Parse(WebReport.Controllers.HomeController.TienDoMLNS().Rows[i][7].ToString())) / 1000000).ToString("#,##0")</td>
                        <td> @Convert.ToDecimal((long.Parse(WebReport.Controllers.HomeController.TienDoMLNS().Rows[i][8].ToString())) / 1000000).ToString("#,##0")</td>
                        <td> @Convert.ToDecimal((long.Parse(WebReport.Controllers.HomeController.TienDoMLNS().Rows[i][9].ToString())) / 1000000).ToString("#,##0")</td>
                    </tr>
                }
            }
        </table>
    </div>

    <div id="TienDo3" class="tabcontent">
        <h3>Tiến độ thực hiện theo loại thuế - tính đến ngày @DateTime.Now.Day/@DateTime.Now.Month/@DateTime.Now.Year.</h3>
        <h5>Đơn vị: Triệu đồng</h5>
        <table class="table">
            <tr style="font-size:15px;width:10%">
                <th>
                    Mã
                </th>
                <th>
                    Chi tiêu
                </th>
                <th>
                    Số thu tháng
                </th>

                <th>
                    Số thu quý
                </th>
                <th>
                    Kế hoạch quý
                </th>
                <th>
                    Tỉ lệ quý
                </th>
                <th>
                    Số thu năm
                </th>
                <th>
                    Kế hoạch năm
                </th>
                <th>
                    Tỉ lệ năm
                </th>
            </tr>

            @for (int i = 0; i < WebReport.Controllers.HomeController.TienDoLT().Rows.Count; i++)
            {
                if (WebReport.Controllers.HomeController.TienDoLT().Rows[i][1].ToString().Equals("0000000"))
                {
            <tr style="font-weight:bold;font-size:15px">
                <td>@WebReport.Controllers.HomeController.TienDoLT().Rows[i][1]</td>
                <td>@WebReport.Controllers.HomeController.TienDoLT().Rows[i][2]</td>
                <td> @Convert.ToDecimal((long.Parse(WebReport.Controllers.HomeController.TienDoLT().Rows[i][3].ToString())) / 1000000).ToString("#,##0")</td>
                <td> @Convert.ToDecimal((long.Parse(WebReport.Controllers.HomeController.TienDoLT().Rows[i][4].ToString())) / 1000000).ToString("#,##0")</td>
                <td> @Convert.ToDecimal((long.Parse(WebReport.Controllers.HomeController.TienDoLT().Rows[i][5].ToString())) / 1000000).ToString("#,##0")</td>
                <td> @Convert.ToDecimal((long.Parse(WebReport.Controllers.HomeController.TienDoLT().Rows[i][6].ToString())) / 1000000).ToString("#,##0")</td>
                <td> @Convert.ToDecimal((long.Parse(WebReport.Controllers.HomeController.TienDoLT().Rows[i][7].ToString())) / 1000000).ToString("#,##0")</td>
                <td> @Convert.ToDecimal((long.Parse(WebReport.Controllers.HomeController.TienDoLT().Rows[i][8].ToString())) / 1000000).ToString("#,##0")</td>
                <td> @Convert.ToDecimal((long.Parse(WebReport.Controllers.HomeController.TienDoLT().Rows[i][9].ToString())) / 1000000).ToString("#,##0")</td>
            </tr>
                }
                else
                {
                    <tr>
                        <td>@WebReport.Controllers.HomeController.TienDoLT().Rows[i][1]</td>
                        <td>@WebReport.Controllers.HomeController.TienDoLT().Rows[i][2]</td>
                        <td> @Convert.ToDecimal((long.Parse(WebReport.Controllers.HomeController.TienDoLT().Rows[i][3].ToString())) / 1000000).ToString("#,##0")</td>
                        <td> @Convert.ToDecimal((long.Parse(WebReport.Controllers.HomeController.TienDoLT().Rows[i][4].ToString())) / 1000000).ToString("#,##0")</td>
                        <td> @Convert.ToDecimal((long.Parse(WebReport.Controllers.HomeController.TienDoLT().Rows[i][5].ToString())) / 1000000).ToString("#,##0")</td>
                        <td> @Convert.ToDecimal((long.Parse(WebReport.Controllers.HomeController.TienDoLT().Rows[i][6].ToString())) / 1000000).ToString("#,##0")</td>
                        <td> @Convert.ToDecimal((long.Parse(WebReport.Controllers.HomeController.TienDoLT().Rows[i][7].ToString())) / 1000000).ToString("#,##0")</td>
                        <td> @Convert.ToDecimal((long.Parse(WebReport.Controllers.HomeController.TienDoCBQL().Rows[i][8].ToString())) / 1000000).ToString("#,##0")</td>
                        <td> @Convert.ToDecimal((long.Parse(WebReport.Controllers.HomeController.TienDoCBQL().Rows[i][9].ToString())) / 1000000).ToString("#,##0")</td>
                    </tr>
                }
            }
        </table>
    </div>
</div>
<script>
    var url = document.URL;
    var kq = url.substring(35, 36);

    if (kq == "") {
        openCity(event, 'TienDo1');
    }
    if (kq == "1") {
        openCity(event, 'TienDo1');
    }
    if (kq == "2") {
        openCity(event, 'TienDo2');
    }
    if (kq == "3") {
        openCity(event, 'TienDo3');
    }
    function openCity(evt, cityName) {
        var i, tabcontent, tablinks;
        tabcontent = document.getElementsByClassName("tabcontent");
        for (i = 0; i < tabcontent.length; i++) {
            tabcontent[i].style.display = "none";
        }
        tablinks = document.getElementsByClassName("tablinks");
        for (i = 0; i < tablinks.length; i++) {
            tablinks[i].className = tablinks[i].className.replace(" active", "");
        }
        document.getElementById(cityName).style.display = "block";
        evt.currentTarget.className += " active";
    }


</script>




